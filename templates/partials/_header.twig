<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

  {# Font Awesome #}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css">

  {# animate css#}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.css">


  {# BOX SLIDER CDN #}
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.css">

  {# Bootstrap Smart Menu #}
  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/jquery.smartmenus/1.1.0/addons/bootstrap-4/jquery.smartmenus.bootstrap-4.css">

  {# Custom CSS #}
  <link rel="stylesheet" href="/styles/main.css">



  {# Global site tag (gtag.js) - Google Analytics #}
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-157717290-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-157717290-1');
  </script>

  {# jquery #}
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
  integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
 
<script type="text/javascript">
						$(document).ready(function() {
							document.cookie="urlParams=utm_campaign=cd_nashville; path=/";
							$("a").not(".noR").attr("href", function(i, oldHref) {
								
								// Skip blank links
								if(!oldHref) {
									return oldHref;
								}
								
								// Skip fragment links
								if(oldHref.indexOf("#") != -1){
									// console.log(oldHref);
									return oldHref;
								} else {
									// console.log(oldHref);
									// Determine if the leading ? is needed
									if(oldHref.indexOf("?") != -1){
										
										// oldHref has existing parameters.
										
										// Split up existing url and params.
										var paramSplitLoc = oldHref.indexOf("?");
										var rawURL = oldHref.slice(0, paramSplitLoc);
										var rawParams = oldHref.slice(paramSplitLoc + 1);
										
										// Get params broken into an array of params with an array of the key and value.
										var existingParamArray = splitParams(rawParams);
										var incomingParamArray = splitParams("utm_campaign=cd_nashville");
										
										// Combine the params into a single array. New params go first!
										var combinedParamArray = incomingParamArray.concat(existingParamArray);
										
										var newParamArray = [];
										
										// Loop through the combined params.
										for (var x = 0; x < combinedParamArray.length; x++) {
											
											// If this is the first pass...
											if(newParamArray.length == 0) {
												// ...just add the param to the new list.
												newParamArray.push(combinedParamArray[x]);	
											} else {
												// Otherwise, compare the current param to those already added to the new list.
												var noMatch = true;
												for (var i = 0; i < newParamArray.length; i++) {
													
													// If any params match, that means a newer version of that param already exists.
													if(combinedParamArray[x][0] == newParamArray[i][0]) {
														// Flag it and bail out!
														noMatch = false;
														break;														
													}											
												}	
												
												// If the current param does not have a flag, add it to the new list.
												if(noMatch) {
													newParamArray.push(combinedParamArray[x]);
												}
											}											
										}	
										
										// Take the array of params and convert it back to a string.
										var newParams = "";
										for (var i = 0; i < newParamArray.length; i++) {
											newParams += newParamArray[i][0] + "=" + newParamArray[i][1] + "&";
										}
										
										// Re-combine the original url with the new param list!
										return rawURL + "?" + newParams.slice(0, -1) ;
										
									} else {
										
										// oldHref does NOT have existing parameters.
                                        
                                        // Is this link R Value only?
                                        if($(this).hasClass("r_value_only")) {
                                            var incomingParamArray = splitParams("utm_campaign=cd_nashville");
                                            
                                            for (var x = 0; x < incomingParamArray.length; x++) {
                                                
                                                if(incomingParamArray[x][0] == "r") {
                                                    return oldHref + "?r=" + incomingParamArray[x][1];
                                                }
                                                
                                            }
                                            
                                        } else 
                                        // Is this link Referrer only?
                                        if($(this).hasClass("referrer_only")) {
                                            var incomingParamArray = splitParams("utm_campaign=cd_nashville");
                                            
                                            for (var x = 0; x < incomingParamArray.length; x++) {
                                                
                                                if(incomingParamArray[x][0] == "r") {
                                                    return oldHref + "?referrer=" + incomingParamArray[x][1];
                                                }
                                                
                                            }
                                            
                                        } else {
                                            
    										// Otherwise, add all the new params to the oldHref.
    										return oldHref + "?utm_campaign=cd_nashville";
                                        }
                                        
									}
								}
							});
							//splitParams(window.location.href.slice(window.location.href.indexOf("?") + 1));
							
						});
						
						function splitParams(paramString) {
							var params = [], hash;
							var paramList = paramString.split("&");
														
							for(var i = 0; i < paramList.length; i++) {
								hash = paramList[i].split("=");
								
								if(hash.length > 1) {								
									var param = [hash[0], hash[1]];
									params.push(param);
								}
							}
							//console.log(params);
							return params;
						}
					</script>